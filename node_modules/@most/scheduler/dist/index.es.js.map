{"version":3,"file":"index.es.js","sources":["../src/ScheduledTask.js","../src/RelativeScheduler.js","../src/task.js","../src/Scheduler.js","../src/Timeline.js","../src/ClockTimer.js","../src/clock.js","../src/schedule.js","../src/relative.js","../src/index.js"],"sourcesContent":["/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nexport default class ScheduledTask {\n  constructor (time, localOffset, period, task, scheduler) {\n    this.time = time\n    this.localOffset = localOffset\n    this.period = period\n    this.task = task\n    this.scheduler = scheduler\n    this.active = true\n  }\n\n  run () {\n    return this.task.run(this.time - this.localOffset)\n  }\n\n  error (e) {\n    return this.task.error(this.time - this.localOffset, e)\n  }\n\n  dispose () {\n    this.scheduler.cancel(this)\n    return this.task.dispose()\n  }\n}\n","export default class RelativeScheduler {\n  constructor (origin, scheduler) {\n    this.origin = origin\n    this.scheduler = scheduler\n  }\n\n  currentTime () {\n    return this.scheduler.currentTime() - this.origin\n  }\n\n  scheduleTask (localOffset, delay, period, task) {\n    return this.scheduler.scheduleTask(localOffset + this.origin, delay, period, task)\n  }\n\n  relative (origin) {\n    return new RelativeScheduler(origin + this.origin, this.scheduler)\n  }\n\n  cancel (task) {\n    return this.scheduler.cancel(task)\n  }\n\n  cancelAll (f) {\n    return this.scheduler.cancelAll(f)\n  }\n}\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nexport const defer = task =>\n  Promise.resolve(task).then(runTask)\n\nexport function runTask (task) {\n  try {\n    return task.run()\n  } catch (e) {\n    return task.error(e)\n  }\n}\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nimport ScheduledTask from './ScheduledTask'\nimport RelativeScheduler from './RelativeScheduler'\nimport { runTask } from './task'\n\nexport default class Scheduler {\n  constructor (timer, timeline) {\n    this.timer = timer\n    this.timeline = timeline\n\n    this._timer = null\n    this._nextArrival = Infinity\n\n    this._runReadyTasksBound = () => this._runReadyTasks(this.currentTime())\n  }\n\n  currentTime () {\n    return this.timer.now()\n  }\n\n  scheduleTask (localOffset, delay, period, task) {\n    const time = this.currentTime() + Math.max(0, delay)\n    const st = new ScheduledTask(time, localOffset, period, task, this)\n\n    this.timeline.add(st)\n    this._scheduleNextRun()\n    return st\n  }\n\n  relative (offset) {\n    return new RelativeScheduler(offset, this)\n  }\n\n  cancel (task) {\n    task.active = false\n    if (this.timeline.remove(task)) {\n      this._reschedule()\n    }\n  }\n\n  cancelAll (f) {\n    this.timeline.removeAll(f)\n    this._reschedule()\n  }\n\n  _reschedule () {\n    if (this.timeline.isEmpty()) {\n      this._unschedule()\n    } else {\n      this._scheduleNextRun(this.currentTime())\n    }\n  }\n\n  _unschedule () {\n    this.timer.clearTimer(this._timer)\n    this._timer = null\n  }\n\n  _scheduleNextRun () { // eslint-disable-line complexity\n    if (this.timeline.isEmpty()) {\n      return\n    }\n\n    const nextArrival = this.timeline.nextArrival()\n\n    if (this._timer === null) {\n      this._scheduleNextArrival(nextArrival)\n    } else if (nextArrival < this._nextArrival) {\n      this._unschedule()\n      this._scheduleNextArrival(nextArrival)\n    }\n  }\n\n  _scheduleNextArrival (nextArrival) {\n    this._nextArrival = nextArrival\n    const delay = Math.max(0, nextArrival - this.currentTime())\n    this._timer = this.timer.setTimer(this._runReadyTasksBound, delay)\n  }\n\n  _runReadyTasks () {\n    this._timer = null\n    this.timeline.runTasks(this.currentTime(), runTask)\n    this._scheduleNextRun()\n  }\n}\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nimport { findIndex, removeAll } from '@most/prelude'\n\nexport default class Timeline {\n  constructor () {\n    this.tasks = []\n  }\n\n  nextArrival () {\n    return this.isEmpty() ? Infinity : this.tasks[0].time\n  }\n\n  isEmpty () {\n    return this.tasks.length === 0\n  }\n\n  add (st) {\n    insertByTime(st, this.tasks)\n  }\n\n  remove (st) {\n    const i = binarySearch(getTime(st), this.tasks)\n\n    if (i >= 0 && i < this.tasks.length) {\n      const at = findIndex(st, this.tasks[i].events)\n      if (at >= 0) {\n        this.tasks[i].events.splice(at, 1)\n        return true\n      }\n    }\n\n    return false\n  }\n\n  removeAll (f) {\n    for (let i = 0; i < this.tasks.length; ++i) {\n      removeAllFrom(f, this.tasks[i])\n    }\n  }\n\n  runTasks (t, runTask) {\n    const tasks = this.tasks\n    const l = tasks.length\n    let i = 0\n\n    while (i < l && tasks[i].time <= t) {\n      ++i\n    }\n\n    this.tasks = tasks.slice(i)\n\n    // Run all ready tasks\n    for (let j = 0; j < i; ++j) {\n      this.tasks = runReadyTasks(runTask, tasks[j].events, this.tasks)\n    }\n  }\n}\n\nfunction runReadyTasks (runTask, events, tasks) { // eslint-disable-line complexity\n  for (let i = 0; i < events.length; ++i) {\n    const task = events[i]\n\n    if (task.active) {\n      runTask(task)\n\n      // Reschedule periodic repeating tasks\n      // Check active again, since a task may have canceled itself\n      if (task.period >= 0 && task.active) {\n        task.time = task.time + task.period\n        insertByTime(task, tasks)\n      }\n    }\n  }\n\n  return tasks\n}\n\nfunction insertByTime (task, timeslots) {\n  const l = timeslots.length\n  const time = getTime(task)\n\n  if (l === 0) {\n    timeslots.push(newTimeslot(time, [task]))\n    return\n  }\n\n  const i = binarySearch(time, timeslots)\n\n  if (i >= l) {\n    timeslots.push(newTimeslot(time, [task]))\n  } else {\n    insertAtTimeslot(task, timeslots, time, i)\n  }\n}\n\nfunction insertAtTimeslot (task, timeslots, time, i) {\n  const timeslot = timeslots[i]\n  if (time === timeslot.time) {\n    addEvent(task, timeslot.events, time)\n  } else {\n    timeslots.splice(i, 0, newTimeslot(time, [task]))\n  }\n}\n\nfunction addEvent (task, events) {\n  if (events.length === 0 || task.time >= events[events.length - 1].time) {\n    events.push(task)\n  } else {\n    spliceEvent(task, events)\n  }\n}\n\nfunction spliceEvent (task, events) {\n  for (let j = 0; j < events.length; j++) {\n    if (task.time < events[j].time) {\n      events.splice(j, 0, task)\n      break\n    }\n  }\n}\n\nfunction getTime (scheduledTask) {\n  return Math.floor(scheduledTask.time)\n}\n\nfunction removeAllFrom (f, timeslot) {\n  timeslot.events = removeAll(f, timeslot.events)\n}\n\nfunction binarySearch (t, sortedArray) { // eslint-disable-line complexity\n  let lo = 0\n  let hi = sortedArray.length\n  let mid, y\n\n  while (lo < hi) {\n    mid = Math.floor((lo + hi) / 2)\n    y = sortedArray[mid]\n\n    if (t === y.time) {\n      return mid\n    } else if (t < y.time) {\n      hi = mid\n    } else {\n      lo = mid + 1\n    }\n  }\n  return hi\n}\n\nconst newTimeslot = (t, events) => ({ time: t, events: events })\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nimport { defer } from './task'\n\n/* global setTimeout, clearTimeout */\n\nexport default class ClockTimer {\n  constructor (clock) {\n    this._clock = clock\n  }\n\n  now () {\n    return this._clock.now()\n  }\n\n  setTimer (f, dt) {\n    return dt <= 0 ? runAsap(f) : setTimeout(f, dt)\n  }\n\n  clearTimer (t) {\n    return t instanceof Asap ? t.cancel() : clearTimeout(t)\n  }\n}\n\nclass Asap {\n  constructor (f) {\n    this.f = f\n    this.active = true\n  }\n\n  run () {\n    return this.active && this.f()\n  }\n\n  error (e) {\n    throw e\n  }\n\n  cancel () {\n    this.active = false\n  }\n}\n\nfunction runAsap (f) {\n  const task = new Asap(f)\n  defer(task)\n  return task\n}\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\n/* global performance, process */\n\nexport class RelativeClock {\n  constructor (clock, origin) {\n    this.origin = origin\n    this.clock = clock\n  }\n\n  now () {\n    return this.clock.now() - this.origin\n  }\n}\n\nexport class HRTimeClock {\n  constructor (hrtime, origin) {\n    this.origin = origin\n    this.hrtime = hrtime\n  }\n\n  now () {\n    const hrt = this.hrtime(this.origin)\n    return (hrt[0] * 1e9 + hrt[1]) / 1e6\n  }\n}\n\nexport const clockRelativeTo = clock =>\n  new RelativeClock(clock, clock.now())\n\nexport const newPerformanceClock = () =>\n  clockRelativeTo(performance)\n\nexport const newDateClock = () =>\n  clockRelativeTo(Date)\n\nexport const newHRTimeClock = () =>\n  new HRTimeClock(process.hrtime, process.hrtime())\n\nexport const newPlatformClock = () => {\n  if (typeof performance !== 'undefined' && typeof performance.now === 'function') {\n    return newPerformanceClock()\n  } else if (typeof process !== 'undefined' && typeof process.hrtime === 'function') {\n    return newHRTimeClock()\n  }\n\n  return newDateClock()\n}\n","import { curry2, curry3 } from '@most/prelude'\n\n// Read the current time from the provided Scheduler\nexport const currentTime = scheduler =>\n  scheduler.currentTime()\n\n// Schedule a task to run as soon as possible, but\n// not in the current call stack\nexport const asap = curry2((task, scheduler) =>\n  scheduler.scheduleTask(0, 0, -1, task))\n\n// Schedule a task to run after a millisecond delay\nexport const delay = curry3((delay, task, scheduler) =>\n  scheduler.scheduleTask(0, delay, -1, task))\n\n// Schedule a task to run periodically, with the\n// first run starting asap\nexport const periodic = curry3((period, task, scheduler) =>\n  scheduler.scheduleTask(0, 0, period, task))\n\n// Cancel a scheduledTask\nexport const cancelTask = scheduledTask =>\n  scheduledTask.dispose()\n\n// Cancel all ScheduledTasks for which a predicate\n// is true\nexport const cancelAllTasks = curry2((predicate, scheduler) =>\n  scheduler.cancelAll(predicate))\n","import RelativeScheduler from './RelativeScheduler'\nimport { curry2 } from '@most/prelude'\n\nexport const schedulerRelativeTo = curry2((offset, scheduler) =>\n  new RelativeScheduler(offset, scheduler))\n","/** @license MIT License (c) copyright 2010-2017 original author or authors */\n\nimport { curry2 } from '@most/prelude'\n\nimport Scheduler from './Scheduler'\nimport Timeline from './Timeline'\nimport ClockTimer from './ClockTimer'\nimport { newPlatformClock } from './clock'\n\nexport * from './clock'\nexport * from './schedule'\nexport * from './relative'\n\nexport const newScheduler = curry2((timer, timeline) => new Scheduler(timer, timeline))\n\nexport const newDefaultScheduler = () => new Scheduler(newDefaultTimer(), new Timeline())\n\nexport const newDefaultTimer = () => new ClockTimer(newPlatformClock())\nexport const newClockTimer = clock => new ClockTimer(clock)\n\nexport const newTimeline = () => new Timeline()\n"],"names":["const","this","let"],"mappings":"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"}